# Medicare Chatbot POC - Intent Recognition & Slot Filling Project Plan

**Document Version:** 1.0
**Date:** 2025-06-05

---

## 1. Executive Summary

This document outlines the Project Plan for a Proof of Concept (POC) to develop a self-service chatbot for Medicare beneficiaries. The primary goal is to empower users to find answers regarding their Medicare plan, coverage, entitlements, options, and drug prices through a conversational interface, reducing reliance on call center interactions and improving accessibility. This POC focuses on demonstrating the core intent recognition and slot filling capabilities, **natural-feeling conversational handling of incomplete information**, and **proactive redirection for out-of-scope queries**, all while strictly ensuring factual accuracy, preventing hallucinations, and maintaining appropriate language use. **Anthropic Claude 3 Haiku will be the primary model tested**, with flexibility to explore other AWS Bedrock models for optimal performance, cost-effectiveness, and response time.

Crucially, this POC is a local, self-contained application, designed solely to explore the capabilities of AWS Bedrock and AWS Medical Comprehend. It won't involve setting up AWS infrastructure beyond what's needed for API access to Bedrock/Comprehend, nor will it be deployed. The output of this POC is working code and documented findings, not a deployable artifact.

---

## 2. Project Goals & Objectives

### 2.1. Business Goals (Long-term Vision - Context for POC)

- **Enhance Self-Service:** Enable Medicare beneficiaries to independently access information about their plans, coverage, entitlements, and drug prices.
- **Improve Accessibility:** Provide information in plain conversational language, reducing the need to navigate complex UIs or large documents.
- **Reduce Call Center Volume:** Decrease inbound call volume related to common Medicare inquiries.

### 2.2. POC Specific Objectives

- **Prove Core AI Capabilities:**
  - **Validate Intent & Slot Accuracy:** Achieve near **100% accuracy** in identifying user intent and extracting relevant slots for a predefined set of initial intents.
  - **Demonstrate Data Grounding:** Prove the ability to generate responses solely based on data retrieved from backend APIs (mocked for POC), **eliminating hallucination (zero tolerance)**.
  - **Test Conversational Flow & Naturalness:** Showcase the system's ability to:
    - Identify missing slots and proactively ask follow-up questions to gather necessary information.
    - Gracefully handle incomplete or ambiguous user inputs.
    - **Proactively redirect users** to appropriate questions or inform them when queries are outside the chatbot's current capabilities.
    - Produce responses that feel natural and empathetic, even when asking for clarification or redirecting.
  - **Maintain Content Safety & Appropriateness:** Ensure **no profane, objectionable, or harmful language** is ever generated by the chatbot.
- **Evaluate Bedrock Models:** Assess **Anthropic Claude 3 Haiku's** performance in terms of response accuracy, conversational flow, cost-effectiveness, and latency. Experiment with other Bedrock models if initial evaluation suggests better alternatives for the specific use case.
- **Explore Prompt Engineering:** Gain hands-on experience and iterate on effective prompt engineering techniques for structured output (JSON) and natural conversation.
- **Understand AWS API Integration:** Learn how to interact with Bedrock and Medical Comprehend APIs directly within application code.

---

## 3. Scope of POC (Minimum Viable Functionality for Local Exploration)

This POC will focus on demonstrating the end-to-end flow for a **handful (2-5)** of well-defined intents within a single, local application environment.

### 3.1. In-Scope Functionality

- **Local User Interface:** A simple chat UI built with **Svelte 5** to simulate user interaction.
- **Local Backend API:** Svelte 5's backend capabilities (`+server.js` or similar) will act as a local API to orchestrate interactions.
- **Intent Recognition & Slot Filling:**
  - Direct API calls to **AWS Bedrock (Anthropic Claude 3 Haiku)** from the local Svelte backend for natural language understanding (NLU).
  - Extraction of key information (slots) from user queries.
  - Identification of missing required slots.
  - Direct API calls to **AWS Medical Comprehend** for specialized Named Entity Recognition (NER) to extract and normalize medical terms (e.g., `drugName`, `dosage`, `drugForm`, `frequency`).
- **Backend Data Simulation:**
  - **Mocked internal functions/data structures** within the Svelte backend to simulate fetching beneficiary-specific data (e.g., plan info, claims, drug pricing) from REST APIs. Data will be simple key-value objects, potentially nested or arrays.
- **Context Management (In-Memory Only):**
  - Maintain conversation context for the current session **solely in application memory** (e.g., a simple array of message objects, a JS object mapping `sessionId` to `conversationState`). Do **not** use external databases or caching services. A session ID can be a simple timestamp.
- **Response Generation:**
  - **Canned Responses:** Simple pre-defined responses handled directly in application code (e.g., a `Map` or `object` linking an intent to a static string).
  - **Grounded Generative Responses:** For other intents, feed mocked API data to **Anthropic Claude 3 Haiku** to generate human-readable responses.
    - **Strict Adherence:** Responses must strictly adhere to provided data; **zero hallucination tolerance.**
  - **Missing Slot Prompting:** Generate natural language questions to elicit missing required slot information from the user, in a natural conversational style.
  - **Out-of-Scope Redirection:** Proactively guide users to relevant in-scope queries or inform them when their question cannot be answered by the current chatbot.
  - **Structured Cards/Links:** Support embedding structured information (e.g., `location`, `drugInfo`, `priceDetails`) or actionable links within the response. The Bedrock response for this should include a **JSON array of objects**, with one required key called `"type"` that would inform the front end what other data to expect in that key-value object and how to display it. `type` might be "location" or "drugInfo" or "priceDetails".
  - **Safety & Compliance:** Implement and enforce strict content filters (via Bedrock's prompt engineering/parameters) to prevent the generation of any profane, objectionable, or harmful language.
- **Local Execution:** The entire POC will run locally on a developer's machine.

### 3.2. Out-of-Scope for POC

- **Any AWS Infrastructure Deployment:** No API Gateway, Lambda functions, DynamoDB tables, ElastiCache instances, Kinesis streams, or other persistent AWS resources will be set up or deployed for this POC.
- **Production Readiness:** No focus on scalability, security hardening beyond basic AWS API key management, robust error logging to external systems, or high availability.
- **Live Backend Integrations:** No direct integration with external REST APIs.
- **Secondary Audience:** Support for Medicare-eligible but not yet enrolled individuals.
- **Advanced ML Training:** Fine-tuning of Bedrock models beyond prompt engineering.
- **A/B Testing or Complex Analytics Infrastructure.**
- **Real-time Response Streaming.**

---

## 4. Key Initial Intents & Slots (Examples for POC)

The POC will focus on a subset of the following (2-5 total):

- **`GetDrugPrice`**:
  - `drugName` (string, required, normalized via Medical Comprehend)
  - `dosage` (string, required, normalized via Medical Comprehend)
  - `drugForm` (string, optional, normalized via Medical Comprehend)
  - `frequency` (string, optional)
  - `duration` (string, optional)
- **`GetPreventiveServices`**:
  - (No specific slots required; assumes beneficiary context)
- **`GetPlanExpiration`**:
  - `planType` (string, optional; e.g., "Part A", "Part B", "Medicare Advantage")
- **`GetPrescriptionCardInfo`**:
  - (No specific slots required; assumes beneficiary context)
- **`Greeting`**:
  - (No specific slots; simple pleasantries)
- **`Unknown`**:
  - (System intent when user query does not match)

---

## 5. Technical Architecture (POC Level - Local & Self-Contained)

This POC will be implemented as a **single, self-contained application** running locally, built with Svelte 5.

### 5.1. Core Components

- **Svelte 5 Application:**
  - **Role:** Provides a simple web-based user interface for chat interaction. Acts as the local backend API for handling requests from the UI.
  - **Responsibilities:**
    - Manages **in-memory conversation context** (user input history, identified intent, extracted slots for the current session).
    - Contains mocked data and logic for backend API responses.
    - Orchestrates direct API calls to AWS Bedrock and AWS Medical Comprehend using the AWS SDK (Boto3 for Python calls if the Svelte backend makes Python subprocess calls, or AWS SDK for JavaScript/TypeScript if directly in JS/TS).
    - Receives user input from the UI and sends responses back.
- **AWS Bedrock (Anthropic Claude 3 Haiku as primary, others for evaluation):**
  - **Role:** The core Large Language Model (LLM) for natural language understanding and generation.
  - **Integration:** Accessed directly via API calls (e.g., Boto3 `bedrock-runtime` client in Python or AWS SDK for JS `BedrockRuntimeClient`) from the Svelte application's backend logic.
  - **Responsibilities:**
    - **Intent Recognition and Slot Filling:** Based on user input and a detailed system prompt, outputs a JSON object with `intent` and `slots`.
    - **Grounded Response Generation:** Given extracted data from mocked APIs, crafts human-readable responses.
    - **Follow-up Question Generation:** Formulates natural questions for missing required slots.
    - **Out-of-Scope Redirection:** Generates polite messages for unanswerable queries.
    - **Content Safety:** Adheres to safety instructions within prompts (no objectionable language).
- **AWS Medical Comprehend:**
  - **Role:** Specialized Named Entity Recognition (NER) for medical terminology.
  - **Integration:** Accessed directly via API calls (e.g., Boto3 `comprehendmedical` client in Python or AWS SDK for JS `ComprehendMedicalClient`) from the Svelte application's backend logic.
  - **Responsibilities:**
    - Extracts and normalizes entities like `drugName`, `dosage`, `drugForm` from user input (e.g., mapping to RxNorm concepts).

### 5.2. Data Flow (Local, In-Memory)

1.  **User Input:** User types a message into the Svelte UI.
2.  **Svelte UI:** Sends the user input to the local Svelte backend API (e.g., via a `fetch` call to `/api/chat`).
3.  **Svelte Backend (Local API):**
    - Receives user input and a unique `sessionId` (can be a simple timestamp on first call, maintained by UI).
    - Retrieves the current `conversationContext` for that `sessionId` from its in-memory store.
    - **Phase 1: Intent & Slot Extraction:**
      - Constructs a detailed Bedrock prompt (including the user input and the current `conversationContext`).
      - The Bedrock prompt should include a `SYSTEM` role message that explicitly defines expected JSON output for intent and slots, possible intents, and current date context for relative date parsing (e.g., "Current Date: 2025-06-05").
      - Use `temperature=0.0`, `top_k=1`, and ` stop_sequences=["```"] ` with a JSON prefill (` "```json\n" `) to enforce JSON output.
      - Calls AWS Bedrock (Claude 3 Haiku) for `intent` and `slots` extraction.
      - If `drugName`, `dosage`, `drugForm` are present or suspected, calls AWS Medical Comprehend to normalize these terms (e.g., `detect_entities_v2`).
      - Consolidates extracted slots:
        - User-provided slots.
        - Normalized slots from Medical Comprehend.
        - Slots "backfilled" from _mocked_ beneficiary data (e.g., `beneficiaryId` from JWT which is _mocked as known_ for POC).
    - **Phase 2: Response Formulation:**
      - Determines if all **required slots** for the identified `intent` are present:
        - If **missing slots**:
          - Constructs a Bedrock prompt with the `intent` and `missingSlots` to generate a polite follow-up question.
        - If **all slots present**:
          - Calls _mocked_ backend API functions (e.g., `mockGetDrugPrice`, `mockGetPreventiveServices`) to retrieve relevant data.
          - Based on `intent` and the retrieved _mocked_ data, determines response type:
            - **Canned Response:** If applicable, retrieves a pre-defined response from an in-code map.
            - **Grounded Generative Response:** If not canned, constructs a Bedrock prompt, feeding the retrieved _mocked_ data explicitly to Bedrock (e.g., in a JSON block or `<data>` tags) to craft a human-readable response. This prompt must include instructions for Bedrock to create structured "Cards" if applicable.
        - If **`intent` is "Unknown" or outside scope**:
          - Constructs a Bedrock prompt to generate a polite redirection message or inform the user of current limitations.
    - Updates the in-memory `conversationContext` with the latest user input, bot response, identified `intent`, and `slots`.
4.  **Svelte Backend:** Returns the structured JSON response (containing text and optionally cards) to the Svelte UI.
5.  **Svelte UI:** Displays the chatbot's response to the user.

---

## 6. Success Metrics for POC

- **Intent Recognition Accuracy:** Achieve >95% accuracy for the defined POC intents on a test dataset (to be evaluated by human review).
- **Slot Filling Accuracy:** Achieve >90% accuracy for extracting and normalizing required slots (to be evaluated by human review).
- **Response Latency:** Observe and document typical response times from Bedrock/Comprehend API calls (target < 5 seconds for total end-to-end local process, including network latency to AWS).
- **JSON Output Reliability:** >99% of Bedrock calls for intent/slot extraction and response generation produce valid, parseable JSON.
- **Hallucination Rate:** **0% hallucination** (zero tolerance, verified through rigorous testing and strict grounding with mocked data).
- **Content Safety:** **0% generation of profane, objectionable, or harmful language** (verified through testing and prompt engineering).
- **Conversation Naturalness & Redirection Effectiveness:** Qualitative assessment (manual review of sample conversations) of how well the bot handles incomplete information, asks follow-up questions, and redirects out-of-scope queries in a natural-feeling way.
- **Prompt Engineering Effectiveness:** Document successful prompt patterns for various scenarios and models.
- **Model Suitability:** Document findings on Claude 3 Haiku's performance.

---

## 7. Development Approach & Tools

- **Iterative Development:** Agile approach, focusing on rapid iteration and feedback.
- **AI Code Agents:** Utilize tools like WindSurf or Cursor to accelerate development. This documentation is the primary input.
- **Programming Language:** JavaScript/TypeScript (primary for Svelte backend) and Python (for direct AWS SDK interaction if preferred for Bedrock/Comprehend calls, or a separate test harness).
- **UI Framework:** Svelte 5.
- **Source Control:** Git (will be managed in a central repository).
- **Code Quality:** Emphasis on clear, modular code.

---

## 8. Next Steps & Future Considerations (Beyond POC)

- **Expand Intent Coverage:** Gradually add more intents and associated slots.
- **Transition to AWS Infrastructure:** Move from local/in-memory components to AWS services (API Gateway, Lambda, DynamoDB, ElastiCache) for scalability and persistence.
- **Live Backend Integration:** Transition from mocked APIs to actual backend REST APIs.
- **Scalability & Observability:** Implement production-ready architecture, logging, monitoring, and alerting.
- **Advanced Context:** Explore techniques for longer-term context memory.
- **User Feedback Loop:** Integrate mechanisms for collecting user feedback to continuously improve chatbot performance.
- **Voice Integration:** Potential for voice input/output in future iterations.

---
